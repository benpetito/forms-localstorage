"use strict";var formsApp=angular.module("formsApp",["ngMessages","angular-data.DSCacheFactory"]);formsApp.controller("MainController",["$scope","$log","$timeout","DSCacheFactory",function($scope,$log,$timeout,DSCacheFactory){$scope.master={firstName:void 0,lastName:void 0,email:void 0,comments:void 0},$scope.saveSuccess=!1,$scope.saveError=!1,$scope.savedForms=[],$scope.submitMessage="0 forms submitted to remote database.",$scope.submitSuccess=!1;var storeJsToStandard={getItem:store.get,setItem:store.set,removeItem:store.remove},CACHE_ID="formsApp",_dataCache=new DSCacheFactory("dataCache",{capacity:1e3,storageMode:"localStorage",storageImpl:storeJsToStandard,verifyIntegrity:!0}),_showSuccess=function(){$scope.saveSuccess=!0,$timeout(function(){$scope.saveSuccess=!1},3e3)},_showSubmitSuccess=function(submittedCount){$scope.submitMessage=submittedCount+" forms submitted to remote database.",$scope.submitSuccess=!0,$timeout(function(){$scope.submitSuccess=!1},5e3)};$scope.init=function(){$scope.reset(),_dataCache.get(CACHE_ID)&&($scope.savedForms=_dataCache.get(CACHE_ID),$log.debug("Loaded "+$scope.savedForms.length+" items from local storage."))},$scope.reset=function(){$scope.user=angular.copy($scope.master),$scope.form1&&$scope.form1.$setPristine()},$scope.submit=function(){$log.debug("Uploading forms to remote server.");var count=$scope.savedForms.length;$scope.savedForms.splice(0,$scope.savedForms.length),_dataCache.put(CACHE_ID,$scope.savedForms),_showSubmitSuccess(count)},$scope.update=function(user){$scope.form1&&$scope.form1.$valid&&($scope.savedForms.push(user),$scope.reset(),_dataCache.put(CACHE_ID,$scope.savedForms),$log.debug("Wrote forms to cache"),_showSuccess())},$scope.init()}]);